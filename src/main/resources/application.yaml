# ==========================================
# üåç GLOBAL CONFIGURATION
# ==========================================
spring:
  application:
    name: smarttask-backend

  jpa:
    open-in-view: false
    hibernate:
      ddl-auto: validate          # ‚úÖ Flyway controls schema creation
    properties:
      hibernate:
        format_sql: true

  flyway:
    enabled: true
    baseline-on-migrate: true
    locations: classpath:db/migration

server:
  port: 8080

# ==========================================
# üìò SWAGGER / OPENAPI CONFIGURATION
# ==========================================
springdoc:
  swagger-ui:
    path: /swagger
    display-request-duration: true
    doc-expansion: none
  api-docs:
    path: /v1/api-docs

# ==========================================
# üîê SECURITY CONFIGURATION
# ==========================================
security:
  jwt:
    issuer: "smarttask"
    access-exp-min: 15           # 15 minutes access token
    refresh-exp-days: 7          # 7 days refresh token
swagger:
  auth:
    username: swagger-admin
    password: swagger@123
# ==========================================
# üîâ LOGGING CONFIGURATION
# ==========================================
logging:
  level:
    org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer: ERROR
    org.hibernate.SQL: DEBUG
    org.springframework.web: INFO
    com.smarttask: DEBUG

# ==========================================
# üîÅ PROFILE SPECIFIC CONFIGS
# ==========================================

# ------------------------------------------
# üßë‚Äçüíª DEVELOPMENT PROFILE (Local setup)
# ------------------------------------------
---
spring:
  config:
    activate:
      on-profile: dev

  datasource:
    url: jdbc:postgresql://localhost:5432/smarttask
    username: smarttask_user
    password: leoyashraj
    driver-class-name: org.postgresql.Driver

  jpa:
    show-sql: true

springdoc:
  api-docs:
    enabled: true
  swagger-ui:
    enabled: true

security:
  jwt:
    # ‚úÖ Use a strong Base64-encoded secret for dev
    secret: "v5n4bzxhS3V5NfW1xQbD12Dg5H3tL3s6u8+7aPZUcXAVyo8yBHYRrxU7v/6Qp5CdgSPyR7hFAT9YFj4w=="

# ------------------------------------------
# ‚òÅÔ∏è PRODUCTION PROFILE (Render)
# ------------------------------------------
---
spring:
  config:
    activate:
      on-profile: prod

  datasource:
    url: ${DB_URL}                # Render env var (e.g. jdbc:postgresql://...)
    username: ${DB_USER}          # Render env var
    password: ${DB_PASSWORD}      # Render env var
    driver-class-name: org.postgresql.Driver

  jpa:
    show-sql: false

springdoc:
  api-docs:
    enabled: true                 # ‚úÖ Keep true if you want Swagger visible on Render
  swagger-ui:
    enabled: true
    path: /swagger

security:
  jwt:
    secret: ${JWT_SECRET}         # Render env var (64-byte base64 key)

# Optional Render tuning
server:
  compression:
    enabled: true
  tomcat:
    threads:
      max: 50
